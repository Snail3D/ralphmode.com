{% extends "base.html" %}

{% block title %}PRDs - Ralph Mode PRD Creator{% endblock %}

{% block content %}
<div class="container">
    <h2 style="color: #00ff00; border-bottom: 1px solid #00ff00; padding-bottom: 10px;">
        > SAVED PRDS
    </h2>

    {% if prds %}
    <div style="margin-top: 20px;">
        {% for prd in prds %}
        <div style="background: #0a0a0a; border: 1px solid #00ff00; padding: 15px; margin-bottom: 10px;">
            <h3 style="color: #00ff00; margin: 0 0 10px 0;">
                > {{ prd.project_name }}
            </h3>
            <p style="color: #00ffff; margin: 5px 0;">
                ID: <code>{{ prd.id }}</code>
            </p>
            <p style="color: #888; margin: 5px 0; font-size: 12px;">
                Created: {{ prd.created_at }}
            </p>
            <div style="margin-top: 10px;">
                <a href="/prd/{{ prd.id }}" class="btn">[VIEW]</a>
                <button onclick="deletePRD('{{ prd.id }}')" class="btn" style="margin-left: 10px;">[DELETE]</button>
            </div>
        </div>
        {% endfor %}
    </div>

    {% if total_pages > 1 %}
    <div style="margin-top: 30px; text-align: center;">
        {% if page > 1 %}
        <a href="?page={{ page - 1 }}" class="btn">[PREV]</a>
        {% endif %}

        <span style="color: #00ff00; margin: 0 10px;">
            Page {{ page }} of {{ total_pages }}
        </span>

        {% if page < total_pages %}
        <a href="?page={{ page + 1 }}" class="btn">[NEXT]</a>
        {% endif %}
    </div>
    {% endif %}

    {% else %}
    <p style="color: #ffff00; margin-top: 20px;">
        > No PRDs found. <a href="{{ url_for('create_prd') }}">[Create your first PRD]</a>
    </p>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script>
async function deletePRD(id) {
    if (!confirm('Delete this PRD? This cannot be undone.')) return;

    try {
        const response = await fetch(`/api/prd/${id}`, {
            method: 'DELETE'
        });

        if (response.ok) {
            location.reload();
        } else {
            alert('Failed to delete PRD');
        }
    } catch (error) {
        alert('Error: ' + error.message);
    }
}
</script>
{% endblock %}
