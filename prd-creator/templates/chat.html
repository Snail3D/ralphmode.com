{% extends "base_chat.html" %}

{% block title %}Chat with Smithers - Ralph Mode PRD Creator{% endblock %}

{% block messages %}
{% if messages %}
{% for msg in messages %}
<div class="message {{ msg.role }}">
    <div class="message-avatar">{{ 'S' if msg.role == 'assistant' else 'U' }}</div>
    <div class="message-content">
        <div class="message-bubble">{{ msg.content | safe }}</div>
        {% if msg.actions %}
        <div class="message-actions">
            {% for action in msg.actions %}
            <button class="action-btn" onclick="handleAction({{ action | tojson | safe }})">{{ action.label }}</button>
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% endfor %}
{% else %}
<div class="welcome-screen">
    <h2>Good evening, Mr. Worms sir!</h2>
    <p>What can I build for you today?</p>
    <div class="suggestion-grid">
        <div class="suggestion-card" onclick="sendSuggestion('I want to build a todo app with Flask')">
            <h4>ğŸ“ Todo App</h4>
            <p>A simple task manager with web interface</p>
        </div>
        <div class="suggestion-card" onclick="sendSuggestion('Build me a REST API for a blog platform')">
            <h4>ğŸ”— REST API</h4>
            <p>Backend API with database integration</p>
        </div>
        <div class="suggestion-card" onclick="sendSuggestion('Create a real-time chat application')">
            <h4>ğŸ’¬ Chat App</h4>
            <p>Real-time messaging with WebSockets</p>
        </div>
        <div class="suggestion-card" onclick="sendSuggestion('I need an e-commerce storefront')">
            <h4>ğŸ›’ E-Commerce</h4>
            <p>Online store with payment integration</p>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
    const sessionId = '{{ session_id or "" }}';

    // Handle URL-based navigation for loading chats
    {% if session_id %}
    window.history.replaceState({}, '', '/chat/{{ session_id }}');
    {% endif %}
</script>
{% endblock %}
